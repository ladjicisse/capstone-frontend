<div class="basket container">

  <h2 class="page-title">Panier</h2>

  <!-- Empty basket -->
  @if(items().length === 0) {
  <div class="empty">
    <p>Ton panier est vide.</p>
    <br />
    <a routerLink="/">Je retourne à la liste de produits</a>
  </div>
  }

  <!-- Basket items -->
  @if(items().length > 0) {
    <div class="basket-list">

    @for(item of items() | basketPipe: searchTerm(); track $index; let i = $index) {
      <div class="basket-item">

      <img [src]="item.product.image"
           [alt]="item.product.name"
           class="item-photo" (click)="goToDetail(item.product.id)" />

      <div class="item-info">
        <h3 class="item-title">{{ item.product.name }}</h3>
        <p class="item-price">{{ item.product.price | currency }}</p>

        <div class="qty-controls">
          <button class="qty-btn" (click)="decreaseQty(i)">−</button>

          <input type="text"
                 [(ngModel)]="item.quantity"
                 readonly
                 class="qty-input" />

          <button class="qty-btn" (click)="increaseQty(i)">+</button>
        </div>
      </div>

      <div class="item-total">
        {{ item.product.price * item.quantity | currency }}
      </div>

      <button class="remove-btn" (click)="removeItem(i)">✕</button>
    </div>
    }
    <!-- Summary -->
    <div class="basket-summary">
      <div class="line">
        <span>Subtotal:</span>
        <span>{{ totalAmount() | currency }}</span>
      </div>

      <div class="line total">
        <span>Total:</span>
        <span>{{ totalAmount() | currency }}</span>
      </div>

      <button class="btn-primary btn-primary" (click)="payNow()">
        Confirmer ma commande
      </button>
    </div>

  </div>
  }
</div>
